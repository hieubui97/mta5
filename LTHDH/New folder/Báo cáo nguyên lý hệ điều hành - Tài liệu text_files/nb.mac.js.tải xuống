
(function(require,define){var DOMAIN,CUSTOMER,ZOTABOX,DOMAIN_STATIC_DIR,DOMAIN_CACHE_DIR;var Stats;var _,async,Class,Widget,DomainRules;var Sly,CookieManager,Request,jQuery;define("Widgets.NotificationBox.BaseTheme",["Depd.TweenMax"],function(t){return Zotabox.Class.extend({parent:null,data:{},elm:null,__constructor:function(t,e,i){this.parent=t,this.data=e,this.elm=i},updateSizeIframe:function(){var t=this.elm.contentDocument.querySelector(".notification_box_wrap"),e=this.elm.contentDocument.querySelector(".notification_box_img"),i=(this.elm.contentDocument.querySelector(".left_area"),jQuery("#ztb-nb-widget-"+this.data.client_hash_id));i.css({display:"block",opacity:"0"});var n=t.clientHeight;jQuery("#ztb-nb-widget-"+this.data.client_hash_id).css("height",n+"px"),jQuery(i).css("height",n+"px");parseInt(jQuery(i).css("height"));jQuery(e).on("load",function(){jQuery(i).css("height",n+"px")}).each(function(){this.complete&&jQuery(this).load()})},initEvent:function(){var t=this,e=(jQuery("#ztb-nb-widget-"+this.data.client_hash_id),this.elm.contentDocument.querySelector(".close_box")),i=this.elm.contentDocument.querySelector(".ztb-notification-link");this.showNotification(),e.onclick=function(){t.closeNotificationBox("byclick")},""!=this.data.link_url&&(i.onclick=function(){Stats.sendEvents2("CT",t.data.monitor_id,t.data.widget_id)})},showNotification:function(){var t=this,e=jQuery("#ztb-nb-widget-"+this.data.client_hash_id);this.updateWidgetPosition(),e.attr("data-disabled","false"),e.show(),e.animate({opacity:1},500,function(){}),t.closeNotificationBox("bytime"),Zotabox.addEvent("resize",window,function(e){t.updateWidgetPosition()})},closeNotificationBox:function(t){var e=this;jQuery("#ztb-nb-widget-"+this.data.client_hash_id);if("byclick"==t&&e.parent.close(),"bytime"==t&&0!==parseInt(e.data.display_time)){var i=1e3*parseInt(e.data.display_time);setTimeout(function(){e.parent.close()},i)}},updateWidgetPosition:function(){var t=jQuery("#ztb-nb-widget-"+this.data.client_hash_id);if(parseInt(jQuery(window).width())>720){var e={left:"",right:"",bottom:"",top:"","margin-left":0};return t.css(e),!1}e={left:"50%",right:"auto"};this.data.offsetTop>50?(e.bottom="10px",e.top="auto"):(e.bottom="auto",e.top="10px"),this.data.offsetLeft>50?(e.left="auto",e.right="10px"):(e.left="10px",e.right="auto"),e["margin-left"]=0,t.css("max-width",parseInt(jQuery(window).width())-20+"px"),parseInt(jQuery(window).width())<345&&"facebook/default"!=this.data.theme_package&&(e.left="50%",e["margin-left"]=-t.width()/2),t.css(e)},getShowingTime:function(){switch(parseInt(this.data.display_time)){case 0:return"always";case 3:return 3e4;case 2:return 1e4;case 1:default:return 5e3}},getCookie:function(t){for(var e=t+"=",i=document.cookie.split(";"),n=0;n<i.length;n++){for(var a=i[n];" "==a.charAt(0);)a=a.substring(1);if(-1!=a.indexOf(e))return a.substring(e.length,a.length)}return""}})}),define("Widgets.NotificationBox.BaseWidgetFunction",["Core.Animation","Core.Request","Depd.LightBox","Depd.CanvasLoader","Depd.ZBLib","Depd.PinterestDialog","Depd.TweenMax","Widgets.NotificationBox.BaseTheme"],function(t,e,i,n,a,o,r,s){return{iframe:null,NotificationBoxIframe:null,onloaded:function(){},initialize:function(){},render:function(){var t=this,e=this.GetDomainNameFromUrl(t.data.link_url);_.extend(this.data,{domain:DOMAIN}),this.data.ZOTABOX_DOMAIN_ACTIONS=ZOTABOX.actions,this.ZBLib=new a,this.iframe=document.createElement("iframe"),this.iframe.setAttribute("frameborder","0"),this.iframe.setAttribute("seamless",!0),this.iframe.setAttribute("id","ztb-nb-widget-"+this.data.client_hash_id),this.iframe.setAttribute("scrolling","no"),this.iframe.setAttribute("frameBorder","0"),this.iframe.setAttribute("class","ztb-nb-widget-iframe");var i=_.once(function(i){t.iframe.contentDocument?iframeDocument=t.iframe.contentDocument:t.iframe.contentWindow&&(iframeDocument=t.iframe.contentWindow.document),iframeDocument.open(),t.iframe.contentWindow._=_,t.iframe.contentWindow.Stats=Stats,t.iframe.contentWindow.ZOTABOX=ZOTABOX,t.iframe.contentWindow.Zotabox=Zotabox,t.iframe.contentWindow.DOMAIN=DOMAIN,t.iframe.contentWindow.ZBLib=t.ZBLib,t.iframe.contentWindow.BaseTheme=new s(t,t.data,t.iframe),iframeDocument.write(t.templates.bar(_.extend({},t.data,{domainName:e}))),iframeDocument.close();var n=document.createElement("style");n.setAttribute("type","text/css"),n.styleSheet?n.styleSheet.cssText=Zotabox.getTemplates("fonts")({STATIC_DOMAIN_URI:[Zotabox.getDomainURIs("static"),"__"+Zotabox.getConfig().version].join("/")}):n.textContent=Zotabox.getTemplates("fonts")({STATIC_DOMAIN_URI:[Zotabox.getDomainURIs("static"),"__"+Zotabox.getConfig().version].join("/")}),iframeDocument.getElementsByTagName("head")[0].appendChild(n);var a=document.createElement("style");a.setAttribute("type","text/css"),a.styleSheet?a.styleSheet.cssText=t.styles.iframe:a.textContent=t.styles.iframe,iframeDocument.getElementsByTagName("head")[0].appendChild(a);var o=0,r=setInterval(function(){return o>40?clearInterval(r):t.iframe.contentWindow.NotificationBox?(_.isFunction(t.onloaded)&&(t.NotificationBoxIframe=new t.iframe.contentWindow.NotificationBox,t.onloaded()),clearInterval(r)):void o++},100)});return Zotabox.addEvent("load",this.iframe,i),this.el.appendChild(this.iframe),this},GetDomainNameFromUrl:function(t){var e;return e=t.length>0?0===t.indexOf("http://")||0===t.indexOf("https://")||0===t.indexOf("//")?t:"http://"+t:window.location.pathname,jQuery("<a></a>").attr("href",e).get()[0].hostname},doShow:function(){var t=this;this.NotificationBoxIframe?this.NotificationBoxIframe.refreshUI():this.onloaded=function(){t.NotificationBoxIframe.refreshUI()}},doHide:function(){var t=jQuery("#ztb-nb-widget-"+this.data.client_hash_id);t.animate({opacity:0},0,function(){t.hide()})}}});define("Widgets.NotificationBox.Mac",["Widgets.NotificationBox.BaseWidgetFunction"],function(t){var i=_.extend(t,{});return Zotabox.Widget.extend(i)});define("Widgets.NotificationBox.Mac.Template",[],{bar:function(obj){obj||(obj={});var __t,__p="",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj){__p+="<!DOCTYPE html>\n<html>\n<head>\n    <title></title>\n    ";var assetUri=[Zotabox.getDomainURIs().static,"__"+Zotabox.getConfig().version].join("/");__p+='\n    <meta charset="utf-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1">\n    <meta http-equiv="Content-Security-Policy" content="default-src *; media-src *; img-src * \'self\' data: blob:; script-src * \'self\' \'unsafe-inline\' \'unsafe-eval\'; style-src * \'self\' \'unsafe-inline\'; font-src * data: ;">\n    <script type="text/javascript" src="'+(null==(__t=assetUri)?"":__t)+'/asset/script/jquery.js"><\/script>\n</head>\n<body>\n    <div class="notification_box_wrap">\n        <div class="left_area">\n            <img class="notification_box_img" src="'+(null==(__t=resizeImageUrl(background_image.cache_path,50))?"":__t)+'" />\n        </div>\n        <div class="right_area">\n            <div class="notification_title">\n                '+(null==(__t=title)?"":__t)+'\n            </div>\n            <div class="notification_description">\n                '+(null==(__t=description)?"":__t)+"\n            </div>\n        </div>\n        ",""!=link_url&&(__p+="\n            <a  "+(null==(__t=isNofollow(convertUrl(link_url)))?"":__t)+' class="ztb-notification-link" ',1==is_new_tab?__p+=' target="_blank" ':__p+=' target="_parent" ',__p+=' href="'+(null==(__t=convertUrl(link_url))?"":__t)+'" ></a>\n        '),__p+='\n        <div class="close_box ',""==close_text&&(__p+="zb-all-icon-close-02"),__p+='">\n            ',""!=close_text&&(__p+="\n                <span>"+(null==(__t=close_text)?"":__t)+"</span>\n            "),__p+='\n        </div>\n        <div class="ztb_clear"></div>\n        ';var USE_LOGO=1;CUSTOMER.zotabox_logo==USE_LOGO&&(__p+='\n        <a href="http://info.zotabox.com/?utm_source='+(null==(__t=window.location.host.replace("www.",""))?"":__t)+'&utm_medium=Notification%20Box&utm_campaign=widget%20referral" title="Powered by Zotabox" target="zotabox" class="zb-nt-logo zb-all-zotabox-logo"></a>\n        '),__p+='\n    </div>\n    <script type="text/javascript">\n        window.NotificationBox = function() {\n            this.initialize();\n        }\n\n        NotificationBox.prototype = {\n            initialize: function() {\n                var _super = this;\n                BaseTheme.updateSizeIframe();\n            },\n            refreshUI: function() {\n                //Set iframe width\n                BaseTheme.updateSizeIframe();\n                BaseTheme.initEvent();\n            }\n        }\n    <\/script>\n    <style type="text/css">/*<![CDATA[*/'+(null==(__t=base_custom_css)?"":__t)+'/*]]>*/</style>\n    <style type="text/css">/*<![CDATA[*/'+(null==(__t=custom_css)?"":__t)+"/*]]>*/</style>\n</body>\n</html>\n"}return __p}});define("Widgets.NotificationBox.Mac.CodeName",[],"notification_box");define("Widgets.NotificationBox.Mac.ClassName",[],"NotificationBox");define("Widgets.NotificationBox.Mac.ThemeName",[],"Mac");define("Widgets.NotificationBox.Mac.Installer",[],function(){return function(callback){DOMAIN=Zotabox.getData().domain;CUSTOMER=Zotabox.getData().customer;ZOTABOX=Zotabox.getDomainURIs();DOMAIN_STATIC_DIR=Zotabox.getDomainURIs().static+'/__'+Zotabox.getConfig().version;DOMAIN_CACHE_DIR=Zotabox.getDomainRoot()+'/'+Zotabox.getConfig().timestamp;_=Zotabox._;async=Zotabox.async;Class=Zotabox.Class;Widget=Zotabox.Widget;DomainRules=Zotabox.DomainRules;Sly=Zotabox.Core.Sly;CookieManager=Zotabox.Core.CookieManager;Request=Zotabox.Core.Request;jQuery=Zotabox.Core.jQuery;Stats=Zotabox.Stats;Zotabox.require(["Widgets.NotificationBox.Mac.CodeName","Widgets.NotificationBox.Mac.ClassName","Widgets.NotificationBox.Mac.ThemeName","Widgets.NotificationBox.Mac","Widgets.NotificationBox.Mac.Template"],function(codeName,className,ThemeName,Widget,templates){return callback.apply(this,[null].concat(arguments));});}});}).apply(Zotabox,[Zotabox.require,Zotabox.define]);